# OPR 자동 채점 시스템

OPR(논술형 시험) 자동 채점, 문제 생성, 학습 가이드를 제공하는 통합 시스템입니다.

## 🚀 빠른 시작 (추천!)

```bash
# GUI 버전 실행 - 버튼 클릭으로 모든 기능 사용!
python opr_gui.py
```

**GUI 버전을 사용하면 버튼만 눌러서 모든 기능을 쉽게 사용할 수 있습니다!**

## 📋 주요 기능

### 1. 자동 채점 프로그램
- **키워드 기반 자동 채점**: 모범답안의 키워드와 매칭하여 점수 산정
- **금지어 감점 처리**: 금지어 사용 시 자동 감점
- **3가지 평가 요소 분석**:
  - 논리·정확성 (40점): 키워드 매칭률 기반
  - 명확·간결성 (30점): S/A/B/C/D 등급
  - 완결성 (30점): S/A/B/C/D 등급
- **상세 피드백 제공**: 빠진 키워드, 발견된 금지어, 개선 사항 안내

### 2. 자동 문제지 생성
- **기출문제 패턴 학습**: 2025년 1교시 문제 구조 분석
- **제시자료 자동 생성**: CEO 메시지, 이메일, 메신저 대화 등
- **난이도별 문제 생성**: Easy / Medium / Hard
- **키워드 자동 추출**: 문제에 맞는 핵심 키워드 제공

### 3. 공부 노하우 제시
- **채점 방식 상세 설명**: 채점자 환경, 프로세스, 가점/감점 기준
- **핵심 작성 전략**: 제시문 단어 그대로 사용, 키워드 많이 포함 등
- **학습 계획 생성**: 4주 단계별 학습 로드맵
- **작성 체크리스트**: 시험 당일 확인사항 12가지

## 🎨 GUI 버전 사용법

### 실행 방법
```bash
python opr_gui.py
```

### GUI 기능

#### 📝 답안 자동 채점
1. "답안 자동 채점" 버튼 클릭
2. 답안 입력:
   - 직접 입력
   - 파일에서 불러오기
   - 샘플 답안 사용
3. "채점하기" 버튼 클릭
4. 팝업창에서 결과 확인

#### 📄 연습 문제 생성
1. "연습 문제 생성" 버튼 클릭
2. 난이도 선택 (쉬움/보통/어려움)
3. "문제 생성하기" 버튼 클릭
4. 생성된 문제 정보 확인
5. 필요시 "전체 문제지 파일로 저장" 클릭

#### 📚 공부 노하우 보기
1. "공부 노하우 보기" 버튼 클릭
2. 스크롤하며 핵심 전략 확인
3. 채점 방식 이해

#### 📅 학습 계획 생성
1. "학습 계획 생성" 버튼 클릭
2. 4주 단계별 계획 확인

#### ✅ 체크리스트 보기
1. "체크리스트 보기" 버튼 클릭
2. 12가지 항목 확인
3. 체크박스로 완료 여부 표시

## 💻 명령줄 버전 사용법

GUI를 사용하지 않고 명령줄로 사용하려면:

```bash
# 대화형 메뉴 실행
python opr_system.py

# 답안 파일 채점
python opr_system.py --grade my_answer.txt

# 연습 문제 생성
python opr_system.py --exam

# 공부 가이드 보기
python opr_system.py --guide
```

### 개별 모듈 실행
```bash
# 1. 자동 채점 시스템 데모
python auto_grading_system.py

# 2. 문제 생성기 데모
python exam_generator.py

# 3. 공부 가이드 데모
python study_guide.py
```

## 📊 채점 시스템 상세

### 채점 기준

| 평가 항목 | 배점 | 평가 방식 |
|---------|------|---------|
| 논리·정확성 | 40점 | 키워드 매칭 (가점) + 금지어 (감점) |
| 명확·간결성 | 30점 | S/A/B/C/D 등급 (채점자 개별 평가) |
| 완결성 | 30점 | S/A/B/C/D 등급 (채점자 개별 평가) |

### 채점 로직

1. **논리·정확성 점수 계산**:
   ```
   기본 점수 = 40점 × (매칭된 키워드 수 / 전체 키워드 수)
   감점 = 금지어 개수 × 2점
   최종 점수 = 기본 점수 - 감점
   ```

2. **명확·간결성 평가**:
   - 불필요한 반복 체크
   - 35자 제한 확인
   - 키워드 나열식 작성 여부

3. **완결성 평가**:
   - 제목 존재 여부
   - 대항목 구조 (1, 2, 3)
   - 중항목 구조 (□, ○, -)
   - 최소 내용량

## 📚 공부 노하우 핵심 요약

### 🎯 핵심 전략 TOP 5

1. **제시문의 단어를 그대로 사용**
   - ❌ 온실가스 억제 → ✅ 온실가스 저감
   - ❌ 친환경 기술수준 부족 → ✅ 친환경 기술수준 미흡

2. **키워드를 최대한 많이 넣어라**
   - 채점자는 200명 답안을 빠르게 채점
   - 키워드를 보고 채점함
   - 모르면 관련 키워드를 최대한 많이 작성

3. **시험지 받으면 먼저 제목, 대제목 작성**
   - 문제에서 틀을 잡고 시작
   - 읽으면서 채워나가기

4. **CEO 메시지에서 추진배경과 향후 일정 추출**
   - CEO가 "~하자" → 향후 계획
   - 전사 행사, 토론회 → 향후 계획

5. **부장과 컴케에서 보고서 틀 확인**
   - 2, 3번에서 보고서 구조 확인
   - 주의사항도 여기서 확인

### ⚠️ 금지사항

- 금지어 사용 (메신저/쪽지에서 확인)
- CEO 중심이 아닌 일정 (예: BP 발표 자료 준비 ✗)
- 타 신재생 사업 관련 (디지털 뉴딜, 한국판 뉴딜, 코로나 등)

## 📁 파일 구조

```
/home/user/test/
├── opr_gui.py                 # ⭐ GUI 메인 프로그램 (추천!)
├── opr_system.py              # 명령줄 통합 프로그램
├── auto_grading_system.py     # 자동 채점 시스템
├── exam_generator.py          # 문제 생성기
├── study_guide.py             # 공부 가이드
├── README.md                  # 이 파일
│
├── 문제지/                     # 기출문제 PDF
│   ├── 25년 OPR 문제(1교시).pdf
│   └── ...
│
└── 모범답안/                   # 모범답안 및 채점 자료
    ├── OPR 채점방식.pdf
    ├── OPR 작성 팁.pdf
    └── ...
```

## 🎓 학습 계획 (4주)

### 1주차: 채점 방식 이해 및 기출문제 분석
- 채점 방식 문서 정독
- 작성 팁 문서 정독
- 기출문제 3개년 분석
- 모범답안과 채점기준 비교

### 2주차: 키워드 추출 연습 및 문제 분석 훈련
- 키워드 추출 연습 (형광펜 활용)
- 제시자료 유형별 특징 파악
- 기출문제 1개 작성 (시간제한 없이)
- 모범답안과 비교

### 3주차: 실전 연습 및 시간 관리
- 기출문제 2개 실전 연습 (150분)
- 자가 채점
- 자신만의 루틴 확립

### 4주차: 최종 점검 및 실전 감각 유지
- 기출문제 2~3개 추가 연습
- 약점 파트 집중 훈련
- 경영연구원 보고서 읽기
- 최신 전력산업 이슈 확인

## 📝 시험 당일 체크리스트

- [ ] 문제지 받으면 제목과 대제목을 먼저 작성
- [ ] CEO 메시지에서 추진배경과 향후 일정 체크
- [ ] 처장/부장 이메일과 메신저에서 보고서 구조 확인
- [ ] 제시자료를 읽으며 키워드에 형광펜 표시
- [ ] 모든 키워드를 문제지에 있는 단어 그대로 사용
- [ ] 금지어를 사용하지 않았는지 확인
- [ ] 각 줄이 35자를 초과하지 않는지 확인
- [ ] 총 26줄 이내로 작성
- [ ] 보고서 구조가 명확한지 확인 (1, 2, 3 → □ → ○ → -)
- [ ] CEO 중심의 향후 일정 작성
- [ ] 단순 키워드 나열이 아닌 논리적 문장
- [ ] 제목은 21자 이내 (HY헤드라인M, 21포인트)

## 🖼️ GUI 스크린샷 설명

### 메인 화면
- 좌측: 5개 메뉴 버튼 (채점, 문제생성, 공부가이드, 학습계획, 체크리스트)
- 우측: 선택한 기능의 작업 패널

### 답안 채점 화면
- 답안 입력 영역 (스크롤 가능)
- 파일 불러오기, 샘플 사용, 지우기 버튼
- 채점하기 버튼
- 결과는 팝업창으로 표시

### 문제 생성 화면
- 난이도 선택 (라디오 버튼)
- 문제 생성하기 버튼
- 생성된 문제 정보 표시
- 파일로 저장 옵션

## 🔍 예시: 샘플 답안 채점

GUI에서 "샘플 답안 사용" 버튼을 누르면 다음과 같은 결과를 볼 수 있습니다:

```
📊 총점: 79.0/100점

=== 논리·정확성 (32.5/40점) ===
키워드 매칭: 13/16개
  - 발견된 키워드: 전력망 건설지연, 발전제약 해소, ...

=== 명확·간결성 (B등급, 21.0/30점) ===
반복되는 단어 발견: 전력망, 발전제약, 해소

=== 완결성 (A등급, 25.5/30점) ===
```

## 🎯 시스템 활용 팁

1. **처음 사용자**:
   ```bash
   python opr_gui.py
   # → "공부 노하우 보기" 클릭하여 먼저 전략 확인
   # → "연습 문제 생성" 클릭하여 연습 문제 만들기
   # → "샘플 답안 사용" 후 "채점하기"로 체험
   ```

2. **실전 연습**:
   ```bash
   python opr_gui.py
   # → "연습 문제 생성" → 파일로 저장
   # → 실제 작성 (워드나 메모장)
   # → "답안 자동 채점" → 파일 불러오기 → 채점
   ```

3. **시험 전날**:
   ```bash
   python opr_gui.py
   # → "공부 노하우 보기" 클릭하여 핵심 전략 재확인
   # → "체크리스트 보기" 클릭하여 당일 확인사항 숙지
   ```

## 💡 GUI 장점

- ✅ **쉬운 사용**: 버튼만 클릭하면 됨
- ✅ **직관적**: 모든 기능이 한 눈에
- ✅ **빠른 접근**: 파일 열기/저장 다이얼로그
- ✅ **실시간 피드백**: 팝업으로 결과 즉시 확인
- ✅ **체크리스트 관리**: 클릭으로 완료 여부 표시

## 🔧 향후 개선 사항

- [ ] PDF 파일 직접 읽기 (PyPDF2, pdfplumber 활용)
- [ ] 웹 인터페이스 추가 (Flask/Streamlit)
- [ ] 실제 채점자 평가 데이터 학습
- [ ] AI 기반 문장 품질 평가 (GPT API 연동)
- [ ] 데이터베이스 저장 (SQLite)
- [ ] 학습 진도 추적 기능
- [ ] 다크 모드 지원

## 🆘 문제 해결

### GUI가 실행되지 않을 때
```bash
# tkinter 설치 확인 (보통 기본 설치됨)
python -m tkinter
# 작은 창이 뜨면 정상

# 안 되면 명령줄 버전 사용
python opr_system.py
```

### 한글이 깨질 때
- "맑은 고딕" 폰트가 없으면 자동으로 기본 폰트 사용
- Linux: `sudo apt-get install fonts-nanum` 실행

## 📖 참고 자료

- `모범답안/OPR 채점방식.pdf`: 실제 채점 프로세스 설명
- `모범답안/OPR 작성 팁.pdf`: 고득점자 작성 노하우
- `모범답안/21년 OPR 고득점(1교시)_채점기준.pdf`: 상세 채점 기준

## 📞 문의

시스템 개선 아이디어나 버그 리포트는 이슈로 등록해주세요.

---

**💡 핵심 요약: 제시문의 키워드를 그대로, 최대한 많이 사용하라!**

**🚀 빠른 시작: `python opr_gui.py` 실행 후 버튼 클릭!**
