# OPR 자동 채점 시스템

OPR(논술형 시험) 자동 채점, 문제 생성, 학습 가이드를 제공하는 통합 시스템입니다.

## 📋 주요 기능

### 1. 자동 채점 프로그램 (auto_grading_system.py)
- **키워드 기반 자동 채점**: 모범답안의 키워드와 매칭하여 점수 산정
- **금지어 감점 처리**: 금지어 사용 시 자동 감점
- **3가지 평가 요소 분석**:
  - 논리·정확성 (40점): 키워드 매칭률 기반
  - 명확·간결성 (30점): S/A/B/C/D 등급
  - 완결성 (30점): S/A/B/C/D 등급
- **상세 피드백 제공**: 빠진 키워드, 발견된 금지어, 개선 사항 안내

### 2. 자동 문제지 생성 (exam_generator.py)
- **기출문제 패턴 학습**: 2025년 1교시 문제 구조 분석
- **제시자료 자동 생성**:
  - CEO 소통 메시지
  - 처장/부장 이메일
  - 메신저 대화 (KepTalk)
  - 산업부/내부 보고서
  - 신문 기사
- **난이도별 문제 생성**: Easy / Medium / Hard
- **키워드 자동 추출**: 문제에 맞는 핵심 키워드 제공

### 3. 공부 노하우 제시 (study_guide.py)
- **채점 방식 상세 설명**:
  - 채점자 환경 이해 (4명 1조, 200명 답안, 짧은 시간)
  - 채점 프로세스 (월~목, 최종 답안 작성)
  - 가점/감점 기준
- **핵심 작성 전략**:
  - 제시문의 단어를 그대로 사용
  - 키워드 최대한 많이 포함
  - 금지어 사용 금지
- **학습 계획 생성**: 4주 단계별 학습 로드맵
- **작성 체크리스트**: 시험 당일 확인사항 12가지

## 🚀 사용 방법

### 통합 프로그램 실행

```bash
# 대화형 메뉴 실행
python opr_system.py

# 답안 파일 채점
python opr_system.py --grade my_answer.txt

# 연습 문제 생성
python opr_system.py --exam

# 공부 가이드 보기
python opr_system.py --guide
```

### 개별 모듈 실행

```bash
# 1. 자동 채점 시스템 데모
python auto_grading_system.py

# 2. 문제 생성기 데모
python exam_generator.py

# 3. 공부 가이드 데모
python study_guide.py
```

## 📊 채점 시스템 상세

### 채점 기준

| 평가 항목 | 배점 | 평가 방식 |
|---------|------|---------|
| 논리·정확성 | 40점 | 키워드 매칭 (가점) + 금지어 (감점) |
| 명확·간결성 | 30점 | S/A/B/C/D 등급 (채점자 개별 평가) |
| 완결성 | 30점 | S/A/B/C/D 등급 (채점자 개별 평가) |

### 채점 로직

1. **논리·정확성 점수 계산**:
   ```
   기본 점수 = 40점 × (매칭된 키워드 수 / 전체 키워드 수)
   감점 = 금지어 개수 × 2점
   최종 점수 = 기본 점수 - 감점
   ```

2. **명확·간결성 평가**:
   - 불필요한 반복 체크
   - 35자 제한 확인
   - 키워드 나열식 작성 여부

3. **완결성 평가**:
   - 제목 존재 여부
   - 대항목 구조 (1, 2, 3)
   - 중항목 구조 (□, ○, -)
   - 최소 내용량

## 📚 공부 노하우 핵심 요약

### 🎯 핵심 전략 TOP 5

1. **제시문의 단어를 그대로 사용**
   - ❌ 온실가스 억제 → ✅ 온실가스 저감
   - ❌ 친환경 기술수준 부족 → ✅ 친환경 기술수준 미흡

2. **키워드를 최대한 많이 넣어라**
   - 채점자는 200명 답안을 빠르게 채점
   - 키워드를 보고 채점함
   - 모르면 관련 키워드를 최대한 많이 작성

3. **시험지 받으면 먼저 제목, 대제목 작성**
   - 문제에서 틀을 잡고 시작
   - 읽으면서 채워나가기

4. **CEO 메시지에서 추진배경과 향후 일정 추출**
   - CEO가 "~하자" → 향후 계획
   - 전사 행사, 토론회 → 향후 계획

5. **부장과 컴케에서 보고서 틀 확인**
   - 2, 3번에서 보고서 구조 확인
   - 주의사항도 여기서 확인

### ⚠️ 금지사항

- 금지어 사용 (메신저/쪽지에서 확인)
- CEO 중심이 아닌 일정 (예: BP 발표 자료 준비 ✗)
- 타 신재생 사업 관련 (디지털 뉴딜, 한국판 뉴딜, 코로나 등)

## 📁 파일 구조

```
/home/user/test/
├── opr_system.py              # 통합 메인 프로그램
├── auto_grading_system.py     # 자동 채점 시스템
├── exam_generator.py          # 문제 생성기
├── study_guide.py             # 공부 가이드
├── study_guide.json           # 학습 가이드 JSON (자동 생성)
├── README.md                  # 이 파일
│
├── 문제지/                     # 기출문제 PDF
│   ├── 25년 OPR 문제(1교시).pdf
│   ├── 24년 OPR 문제(1교시).pdf
│   └── ...
│
└── 모범답안/                   # 모범답안 및 채점 자료
    ├── OPR 채점방식.pdf
    ├── OPR 작성 팁.pdf
    ├── 21년 OPR 고득점(1교시)_채점기준.pdf
    └── ...
```

## 🎓 학습 계획 (4주)

### 1주차: 채점 방식 이해 및 기출문제 분석
- 채점 방식 문서 정독
- 작성 팁 문서 정독
- 기출문제 3개년 분석
- 모범답안과 채점기준 비교

### 2주차: 키워드 추출 연습 및 문제 분석 훈련
- 키워드 추출 연습 (형광펜 활용)
- 제시자료 유형별 특징 파악
- 기출문제 1개 작성 (시간제한 없이)
- 모범답안과 비교

### 3주차: 실전 연습 및 시간 관리
- 기출문제 2개 실전 연습 (150분)
- 자가 채점
- 자신만의 루틴 확립

### 4주차: 최종 점검 및 실전 감각 유지
- 기출문제 2~3개 추가 연습
- 약점 파트 집중 훈련
- 경영연구원 보고서 읽기
- 최신 전력산업 이슈 확인

## 📝 시험 당일 체크리스트

- [ ] 문제지 받으면 제목과 대제목을 먼저 작성
- [ ] CEO 메시지에서 추진배경과 향후 일정 체크
- [ ] 처장/부장 이메일과 메신저에서 보고서 구조 확인
- [ ] 제시자료를 읽으며 키워드에 형광펜 표시
- [ ] 모든 키워드를 문제지에 있는 단어 그대로 사용
- [ ] 금지어를 사용하지 않았는지 확인
- [ ] 각 줄이 35자를 초과하지 않는지 확인
- [ ] 총 26줄 이내로 작성
- [ ] 보고서 구조가 명확한지 확인 (1, 2, 3 → □ → ○ → -)
- [ ] CEO 중심의 향후 일정 작성
- [ ] 단순 키워드 나열이 아닌 논리적 문장
- [ ] 제목은 21자 이내 (HY헤드라인M, 21포인트)

## 🔍 예시: 샘플 답안 채점

```bash
$ python opr_system.py --grade sample.txt

📊 채점 결과
============================================================

=== 논리·정확성 (36.0/40점) ===
키워드 매칭: 18/20개
  - 발견된 키워드: 전력망 건설지연, 발전제약 해소, 법령 제개정, ...
  ⚠️ 금지어 발견 (-0점):

=== 명확·간결성 (A등급, 25.5/30점) ===

=== 완결성 (A등급, 25.5/30점) ===

==================================================
📊 총점: 87.0/100점
```

## 💡 주요 기능 설명

### 1. 키워드 매칭 알고리즘

```python
# 공백 제거 후 키워드 매칭
normalized_answer = answer_text.replace(' ', '')
normalized_keyword = keyword.replace(' ', '')

# 키워드 출현 횟수 계산
count = normalized_answer.count(normalized_keyword)
```

### 2. 금지어 검사

```python
# 금지어 발견 시 감점 (-2점/개)
for forbidden in forbidden_keywords:
    if normalized_forbidden in normalized_answer:
        penalty += 2
```

### 3. 정성평가 (명확·간결성, 완결성)

- 반복 단어 검사 (5회 이상 반복 → 감점)
- 35자 제한 확인
- 보고서 구조 분석 (제목, 대항목, 중항목)

## 🎯 시스템 활용 팁

1. **처음 사용자**:
   ```bash
   python study_guide.py  # 먼저 공부 가이드 확인
   python exam_generator.py  # 연습 문제 생성
   python auto_grading_system.py  # 샘플 답안 채점 체험
   ```

2. **실전 연습**:
   ```bash
   python opr_system.py
   # → 메뉴 2번: 연습 문제 생성
   # → 실제 작성
   # → 메뉴 1번: 답안 채점
   ```

3. **시험 전날**:
   ```bash
   python opr_system.py --guide  # 핵심 전략 재확인
   # 메뉴 5번: 체크리스트 출력하여 숙지
   ```

## 🔧 향후 개선 사항

- [ ] PDF 파일 직접 읽기 (PyPDF2, pdfplumber 활용)
- [ ] 웹 인터페이스 추가 (Flask/Streamlit)
- [ ] 실제 채점자 평가 데이터 학습
- [ ] AI 기반 문장 품질 평가 (GPT API 연동)
- [ ] 데이터베이스 저장 (SQLite)
- [ ] 학습 진도 추적 기능

## 📖 참고 자료

- `모범답안/OPR 채점방식.pdf`: 실제 채점 프로세스 설명
- `모범답안/OPR 작성 팁.pdf`: 고득점자 작성 노하우
- `모범답안/21년 OPR 고득점(1교시)_채점기준.pdf`: 상세 채점 기준
- `모범답안/2OR02051.jpg`: 신성장 동력 확보를 위한 국내 해상풍력 사업추진 체크리스트

## 📞 문의

시스템 개선 아이디어나 버그 리포트는 이슈로 등록해주세요.

---

**💡 핵심 요약: 제시문의 키워드를 그대로, 최대한 많이 사용하라!**
